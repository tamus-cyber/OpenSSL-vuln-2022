lsof 2>/dev/null | grep -o \ /.*/.*libcrypto[^\ ]* | sort | uniq | sed 's/^.\{1\}//' | tr '\n' '\0' | xargs -0 -n1 -i sh -c 'strings "{}" | case "$(grep OpenSSL\ 3)" in *OpenSSL*) echo "\nProcesses using affected OpenSSL library {} found:\n" && lsof +c0 2>/dev/null | grep {} | grep -o "^[^ ]*" | sort | uniq;; esac' && lsof 2>/dev/null | grep -o \ /.*/.*libssl[^\ ]* | sort | uniq | sed 's/^.\{1\}//' | tr '\n' '\0' | xargs -0 -n1 -i sh -c 'strings "{}" | case "$(grep OPENSSL_3)" in *OPENSSL*) echo "\nProcesses using affected OpenSSL library {} found:\n" && lsof +c0 2>/dev/null | grep {} | grep -o "^[^ ]*" | sort | uniq;; esac' && find /usr/lib -type f -name *libcrypto* -exec sh -c 'strings $0 | case "$(grep OpenSSL\ 3)" in *OpenSSL*) echo "\nVulnerable OpenSSL library found: $0\n";; esac' {} ';' && find /usr/lib -type f -name *libssl* -exec sh -c 'strings $0 | case "$(grep OPENSSL_3)" in *OPENSSL*) echo "\nVulnerable OpenSSL library found: $0\n";; esac' {} ';' && case "$(openssl version 2>/dev/null)" in *OpenSSL\ 3*) echo "Found vulnerable OpenSSL package: $(openssl version)";; esac